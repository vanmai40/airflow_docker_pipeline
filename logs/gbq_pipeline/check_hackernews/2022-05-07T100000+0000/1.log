[2022-06-06 17:21:27,566] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: gbq_pipeline.check_hackernews 2022-05-07T10:00:00+00:00 [queued]>
[2022-06-06 17:21:27,583] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: gbq_pipeline.check_hackernews 2022-05-07T10:00:00+00:00 [queued]>
[2022-06-06 17:21:27,583] {taskinstance.py:1042} INFO - 
--------------------------------------------------------------------------------
[2022-06-06 17:21:27,584] {taskinstance.py:1043} INFO - Starting attempt 1 of 3
[2022-06-06 17:21:27,584] {taskinstance.py:1044} INFO - 
--------------------------------------------------------------------------------
[2022-06-06 17:21:27,591] {taskinstance.py:1063} INFO - Executing <Task(BigQueryCheckOperator): check_hackernews> on 2022-05-07T10:00:00+00:00
[2022-06-06 17:21:27,595] {standard_task_runner.py:52} INFO - Started process 111 to run task
[2022-06-06 17:21:27,597] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'gbq_pipeline', 'check_hackernews', '2022-05-07T10:00:00+00:00', '--job-id', '670', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/gbq_pipeline.py', '--cfg-path', '/tmp/tmpm9etgqmw', '--error-file', '/tmp/tmpkahb6b0_']
[2022-06-06 17:21:27,599] {standard_task_runner.py:77} INFO - Job 670: Subtask check_hackernews
[2022-06-06 17:21:27,632] {logging_mixin.py:104} INFO - Running <TaskInstance: gbq_pipeline.check_hackernews 2022-05-07T10:00:00+00:00 [running]> on host f3f1e04b5b71
[2022-06-06 17:21:27,660] {taskinstance.py:1257} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=airflow@airflow.com
AIRFLOW_CTX_DAG_OWNER=vanmai-airflow
AIRFLOW_CTX_DAG_ID=gbq_pipeline
AIRFLOW_CTX_TASK_ID=check_hackernews
AIRFLOW_CTX_EXECUTION_DATE=2022-05-07T10:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-05-07T10:00:00+00:00
[2022-06-06 17:21:27,661] {sql.py:87} INFO - Executing SQL check: 
        SELECT "20220507" IN
            (
            SELECT FORMAT_TIMESTAMP("%Y%m%d", timestamp ) AS date
            FROM `bigquery-public-data.hacker_news.full`
            WHERE type = 'story'
            )
        
[2022-06-06 17:21:27,669] {logging_mixin.py:104} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:120 DeprecationWarning: This method will be deprecated. Please use `BigQueryHook.get_client` method
[2022-06-06 17:21:28,015] {logging_mixin.py:104} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:2052 DeprecationWarning: This method is deprecated. Please use `BigQueryHook.insert_job` method.
[2022-06-06 17:21:28,015] {bigquery.py:1510} INFO - Inserting job airflow_1654536088015536_238c852a5705f851ab6aa2ccf3d7633d
[2022-06-06 17:21:29,815] {sql.py:90} INFO - Record: [True]
[2022-06-06 17:21:29,815] {sql.py:96} INFO - Success.
[2022-06-06 17:21:29,823] {taskinstance.py:1166} INFO - Marking task as SUCCESS. dag_id=gbq_pipeline, task_id=check_hackernews, execution_date=20220507T100000, start_date=20220606T172127, end_date=20220606T172129
[2022-06-06 17:21:30,000] {taskinstance.py:1220} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-06 17:21:30,022] {local_task_job.py:146} INFO - Task exited with return code 0
[2022-06-06 17:23:13,411] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: gbq_pipeline.check_hackernews 2022-05-07T10:00:00+00:00 [queued]>
[2022-06-06 17:23:13,432] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: gbq_pipeline.check_hackernews 2022-05-07T10:00:00+00:00 [queued]>
[2022-06-06 17:23:13,432] {taskinstance.py:1042} INFO - 
--------------------------------------------------------------------------------
[2022-06-06 17:23:13,432] {taskinstance.py:1043} INFO - Starting attempt 1 of 3
[2022-06-06 17:23:13,433] {taskinstance.py:1044} INFO - 
--------------------------------------------------------------------------------
[2022-06-06 17:23:13,440] {taskinstance.py:1063} INFO - Executing <Task(BigQueryCheckOperator): check_hackernews> on 2022-05-07T10:00:00+00:00
[2022-06-06 17:23:13,443] {standard_task_runner.py:52} INFO - Started process 168 to run task
[2022-06-06 17:23:13,446] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'gbq_pipeline', 'check_hackernews', '2022-05-07T10:00:00+00:00', '--job-id', '689', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/gbq_pipeline.py', '--cfg-path', '/tmp/tmpmxkbzbly', '--error-file', '/tmp/tmp4ieo1mlh']
[2022-06-06 17:23:13,448] {standard_task_runner.py:77} INFO - Job 689: Subtask check_hackernews
[2022-06-06 17:23:13,481] {logging_mixin.py:104} INFO - Running <TaskInstance: gbq_pipeline.check_hackernews 2022-05-07T10:00:00+00:00 [running]> on host f3f1e04b5b71
[2022-06-06 17:23:13,512] {taskinstance.py:1257} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=airflow@airflow.com
AIRFLOW_CTX_DAG_OWNER=vanmai-airflow
AIRFLOW_CTX_DAG_ID=gbq_pipeline
AIRFLOW_CTX_TASK_ID=check_hackernews
AIRFLOW_CTX_EXECUTION_DATE=2022-05-07T10:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-05-07T10:00:00+00:00
[2022-06-06 17:23:13,514] {sql.py:87} INFO - Executing SQL check: 
        SELECT "20220507" IN
            (
            SELECT FORMAT_TIMESTAMP("%Y%m%d", timestamp ) AS date
            FROM `bigquery-public-data.hacker_news.full`
            WHERE type = 'story'
            )
        
[2022-06-06 17:23:13,522] {logging_mixin.py:104} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:120 DeprecationWarning: This method will be deprecated. Please use `BigQueryHook.get_client` method
[2022-06-06 17:23:13,893] {logging_mixin.py:104} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:2052 DeprecationWarning: This method is deprecated. Please use `BigQueryHook.insert_job` method.
[2022-06-06 17:23:13,894] {bigquery.py:1510} INFO - Inserting job airflow_1654536193894269_238c852a5705f851ab6aa2ccf3d7633d
[2022-06-06 17:23:15,320] {sql.py:90} INFO - Record: [True]
[2022-06-06 17:23:15,322] {sql.py:96} INFO - Success.
[2022-06-06 17:23:15,333] {taskinstance.py:1166} INFO - Marking task as SUCCESS. dag_id=gbq_pipeline, task_id=check_hackernews, execution_date=20220507T100000, start_date=20220606T172313, end_date=20220606T172315
[2022-06-06 17:23:15,359] {taskinstance.py:1220} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-06 17:23:15,390] {local_task_job.py:146} INFO - Task exited with return code 0
