[2022-06-06 17:21:20,584] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: gbq_pipeline.check_hackernews 2022-05-05T10:00:00+00:00 [queued]>
[2022-06-06 17:21:20,603] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: gbq_pipeline.check_hackernews 2022-05-05T10:00:00+00:00 [queued]>
[2022-06-06 17:21:20,604] {taskinstance.py:1042} INFO - 
--------------------------------------------------------------------------------
[2022-06-06 17:21:20,604] {taskinstance.py:1043} INFO - Starting attempt 1 of 3
[2022-06-06 17:21:20,604] {taskinstance.py:1044} INFO - 
--------------------------------------------------------------------------------
[2022-06-06 17:21:20,613] {taskinstance.py:1063} INFO - Executing <Task(BigQueryCheckOperator): check_hackernews> on 2022-05-05T10:00:00+00:00
[2022-06-06 17:21:20,618] {standard_task_runner.py:52} INFO - Started process 99 to run task
[2022-06-06 17:21:20,622] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'gbq_pipeline', 'check_hackernews', '2022-05-05T10:00:00+00:00', '--job-id', '666', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/gbq_pipeline.py', '--cfg-path', '/tmp/tmp2r2jhxz9', '--error-file', '/tmp/tmpgugsvwyt']
[2022-06-06 17:21:20,624] {standard_task_runner.py:77} INFO - Job 666: Subtask check_hackernews
[2022-06-06 17:21:20,665] {logging_mixin.py:104} INFO - Running <TaskInstance: gbq_pipeline.check_hackernews 2022-05-05T10:00:00+00:00 [running]> on host f3f1e04b5b71
[2022-06-06 17:21:20,702] {taskinstance.py:1257} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=airflow@airflow.com
AIRFLOW_CTX_DAG_OWNER=vanmai-airflow
AIRFLOW_CTX_DAG_ID=gbq_pipeline
AIRFLOW_CTX_TASK_ID=check_hackernews
AIRFLOW_CTX_EXECUTION_DATE=2022-05-05T10:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-05-05T10:00:00+00:00
[2022-06-06 17:21:20,703] {sql.py:87} INFO - Executing SQL check: 
        SELECT "20220505" IN
            (
            SELECT FORMAT_TIMESTAMP("%Y%m%d", timestamp ) AS date
            FROM `bigquery-public-data.hacker_news.full`
            WHERE type = 'story'
            )
        
[2022-06-06 17:21:20,711] {logging_mixin.py:104} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:120 DeprecationWarning: This method will be deprecated. Please use `BigQueryHook.get_client` method
[2022-06-06 17:21:21,155] {logging_mixin.py:104} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:2052 DeprecationWarning: This method is deprecated. Please use `BigQueryHook.insert_job` method.
[2022-06-06 17:21:21,156] {bigquery.py:1510} INFO - Inserting job airflow_1654536081155665_15cb24239366b25f8aa5ef568799ce72
[2022-06-06 17:21:23,066] {sql.py:90} INFO - Record: [True]
[2022-06-06 17:21:23,066] {sql.py:96} INFO - Success.
[2022-06-06 17:21:23,073] {taskinstance.py:1166} INFO - Marking task as SUCCESS. dag_id=gbq_pipeline, task_id=check_hackernews, execution_date=20220505T100000, start_date=20220606T172120, end_date=20220606T172123
[2022-06-06 17:21:23,215] {taskinstance.py:1220} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-06 17:21:23,247] {local_task_job.py:146} INFO - Task exited with return code 0
[2022-06-06 17:23:06,998] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: gbq_pipeline.check_hackernews 2022-05-05T10:00:00+00:00 [queued]>
[2022-06-06 17:23:07,021] {taskinstance.py:851} INFO - Dependencies all met for <TaskInstance: gbq_pipeline.check_hackernews 2022-05-05T10:00:00+00:00 [queued]>
[2022-06-06 17:23:07,021] {taskinstance.py:1042} INFO - 
--------------------------------------------------------------------------------
[2022-06-06 17:23:07,021] {taskinstance.py:1043} INFO - Starting attempt 1 of 3
[2022-06-06 17:23:07,022] {taskinstance.py:1044} INFO - 
--------------------------------------------------------------------------------
[2022-06-06 17:23:07,028] {taskinstance.py:1063} INFO - Executing <Task(BigQueryCheckOperator): check_hackernews> on 2022-05-05T10:00:00+00:00
[2022-06-06 17:23:07,032] {standard_task_runner.py:52} INFO - Started process 156 to run task
[2022-06-06 17:23:07,035] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'gbq_pipeline', 'check_hackernews', '2022-05-05T10:00:00+00:00', '--job-id', '685', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/gbq_pipeline.py', '--cfg-path', '/tmp/tmpqvbhujsp', '--error-file', '/tmp/tmpqwjhnqn2']
[2022-06-06 17:23:07,037] {standard_task_runner.py:77} INFO - Job 685: Subtask check_hackernews
[2022-06-06 17:23:07,075] {logging_mixin.py:104} INFO - Running <TaskInstance: gbq_pipeline.check_hackernews 2022-05-05T10:00:00+00:00 [running]> on host f3f1e04b5b71
[2022-06-06 17:23:07,106] {taskinstance.py:1257} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=airflow@airflow.com
AIRFLOW_CTX_DAG_OWNER=vanmai-airflow
AIRFLOW_CTX_DAG_ID=gbq_pipeline
AIRFLOW_CTX_TASK_ID=check_hackernews
AIRFLOW_CTX_EXECUTION_DATE=2022-05-05T10:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-05-05T10:00:00+00:00
[2022-06-06 17:23:07,108] {sql.py:87} INFO - Executing SQL check: 
        SELECT "20220505" IN
            (
            SELECT FORMAT_TIMESTAMP("%Y%m%d", timestamp ) AS date
            FROM `bigquery-public-data.hacker_news.full`
            WHERE type = 'story'
            )
        
[2022-06-06 17:23:07,116] {logging_mixin.py:104} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:120 DeprecationWarning: This method will be deprecated. Please use `BigQueryHook.get_client` method
[2022-06-06 17:23:07,546] {logging_mixin.py:104} WARNING - /home/airflow/.local/lib/python3.6/site-packages/airflow/providers/google/cloud/hooks/bigquery.py:2052 DeprecationWarning: This method is deprecated. Please use `BigQueryHook.insert_job` method.
[2022-06-06 17:23:07,547] {bigquery.py:1510} INFO - Inserting job airflow_1654536187546561_15cb24239366b25f8aa5ef568799ce72
[2022-06-06 17:23:08,837] {sql.py:90} INFO - Record: [True]
[2022-06-06 17:23:08,837] {sql.py:96} INFO - Success.
[2022-06-06 17:23:08,844] {taskinstance.py:1166} INFO - Marking task as SUCCESS. dag_id=gbq_pipeline, task_id=check_hackernews, execution_date=20220505T100000, start_date=20220606T172307, end_date=20220606T172308
[2022-06-06 17:23:08,875] {taskinstance.py:1220} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-06 17:23:08,896] {local_task_job.py:146} INFO - Task exited with return code 0
